import{A as Ee,B as _e,a as x,b as ae,c as se,d as le,e as ce,f as pe,h as de,i as v,k as ue,m as me,n as m,o as he,p as fe,q as ge,r as ve,s as ye,t as Se,u as Ce,v as xe,w as Ie,x as be,y as Ae,z as O}from"./chunk-3NVM47Q4.js";import{$ as h,$a as C,Aa as f,B as S,Ca as z,Cb as ie,Da as W,Ea as X,Ga as Y,Ha as Z,Ka as w,Kb as ne,Mb as A,O as V,P as L,Qa as J,R as b,Sa as K,Va as Q,Wa as P,X as s,Xa as M,Ya as R,Za as c,_a as l,bb as F,ca as $,db as k,e as _,eb as p,f as U,fb as N,ib as g,lb as ee,mb as te,p as B,q as I,t as G,tb as re,va as q,wb as T,xb as oe}from"./chunk-F36XKKPI.js";var j=_(O());var d=function(i){return i.checking="checking",i.authenticated="authenticated",i.notAuthenticated="notAuthenticated",i}(d||{});var D=_(O());var y=(()=>{let e=class e{constructor(){this.http=s(ae),this.url=`${Ee.baseUrl}/users`,this.httpHeaders=new x({"Content-Type":"application/json"}),this._currentUser=w(null),this._authStatus=w(d.notAuthenticated),this.currentUser=T(()=>this._currentUser()),this.authStatus=T(()=>this._authStatus())}logout(){localStorage.removeItem("user"),localStorage.removeItem("token"),localStorage.removeItem("activeMenu"),localStorage.removeItem("lastPath"),localStorage.removeItem("lastMenuPath"),this._currentUser.set(null),this._authStatus.set(d.notAuthenticated)}login(o){return this._authStatus.set(d.checking),this.http.post(`${this.url}/signin`,o,{headers:this.httpHeaders}).pipe(V(t=>{if(t.success){let{user:n,token:a}=t.data;this.saveInfoAsLogin(n,a)}}),S(t=>(D.default.fire("Error Interno","Ha ocurrido algo grave. Contacte a soporte por favor","error"),this._authStatus.set(d.notAuthenticated),I(()=>t))))}validateTokenToServer(o){let t=new x({"Content-Type":"application/json","access-token":o});return this.http.post(`${this.url}/tokenVerify`,"",{headers:t}).pipe(G(n=>this.saveInfoAsLogin(n.data.user,n.data.token)),S(n=>(D.default.fire("Error Interno","Ha ocurrido algo grave. Contacte a soporte por favor","error"),this._authStatus.set(d.notAuthenticated),B(!1))))}saveInfoAsLogin(o,t){return this._currentUser.set(o),this._authStatus.set(d.authenticated),localStorage.setItem("token",t),!0}};e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=b({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function Ue(i,e){if(i&1&&(c(0,"option",12),p(1),l()),i&2){let r=e.$implicit;k("value",r.Id),f(),N(r.Nombre)}}function Be(i,e){i&1&&M(0,Ue,2,2,"option",12,P),i&2&&R(e)}function Ge(i,e){if(i&1&&(c(0,"option",12),p(1),l()),i&2){let r=e.$implicit;k("value",r.Id),f(),N(r.Nombre)}}var we=(()=>{let e=class e{constructor(){this.fb=s(Ie),this.authService=s(y),this.entitesService=s(_e),this.router=s(v),this.cdRef=s(re),this.areas=[],this.change=!0,this.loginForm=this.fb.group({username:["Raulito",[m.required,m.minLength(3)]],password:["0000",[m.required,m.minLength(3)]],entity:[,[m.required]],areaEntitie:[,[m.required]]}),this.authStatusChangedEffect=oe(()=>U(this,null,function*(){this.entitiesSelectResults$=this.entitesService.getAllEntities(),this.cdRef.detectChanges()}))}onSubmit(){let{username:o,password:t,entity:n,areaEntitie:a}=this.loginForm.value;if(n===null||a===null){j.default.fire("Error","Seleccione la Entidad","error");return}this.authService.login({username:o,password:t,entity:n,area:a}).subscribe(u=>{if(!u.success){j.default.fire("Inicio de Sesi\xF3n",u.api_message,"error");return}localStorage.setItem("lastPath","/dashboard"),this.router.navigateByUrl("/dashboard")})}onEntityChange(){this.entitesService.getAllEntitiesArea(this.loginForm.value.entity).subscribe(o=>{for(let t of o)this.areas.push(t);this.cdRef.detectChanges()})}isChecking(){return this.authService.authStatus()===d.checking}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h({type:e,selectors:[["app-auth"]],standalone:!0,features:[g],decls:27,vars:4,consts:[[1,"main-container"],[1,"card-form"],[3,"formGroup"],[1,"container-input"],["for","user"],["formControlName","username","placeholder","Nombre de usuario","type","text","id","user"],["for","password"],["formControlName","password","placeholder","CLave de acceso","type","password","id","password"],["for",""],["formControlName","entity","name","entitie","id","select-concept",3,"change"],["for","areaEntitie"],["formControlName","areaEntitie","name","areaEntitie","id","select-concept"],[3,"value"],[3,"click"]],template:function(t,n){if(t&1&&(c(0,"div",0)(1,"div",1)(2,"form",2)(3,"h2"),p(4,"Iniciar Sesi\xF3n"),l(),c(5,"div",3)(6,"label",4),p(7,"User"),l(),C(8,"input",5),l(),c(9,"div",3)(10,"label",6),p(11,"Password"),l(),C(12,"input",7),l(),c(13,"div",3)(14,"label",8),p(15,"Seleccione la Entidad"),l(),c(16,"select",9),F("change",function(){return n.onEntityChange()}),J(17,Be,2,0),ee(18,"async"),l()(),c(19,"div",3)(20,"label",10),p(21,"Seleccione el Area"),l(),c(22,"select",11),M(23,Ge,2,2,"option",12,P),l()(),c(25,"button",13),F("click",function(){return n.onSubmit()}),p(26,"Acceder"),l()()()()),t&2){let a;f(2),K("formGroup",n.loginForm),f(15),Q((a=te(18,2,n.entitiesSelectResults$))?17:-1,a),f(6),R(n.areas)}},dependencies:[Ae,ge,Ce,xe,me,Se,he,fe,ve,ye,A,ne,be],styles:[".main-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh}.card-form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:500px;height:400px;border-radius:10px;box-shadow:0 0 8px #0003}form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;height:100%;width:100%;gap:10px}select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{height:100%;width:100%;border:1px solid transparent;box-shadow:0 0 3px #0003;padding-left:10px}button[_ngcontent-%COMP%]{background-color:#09f;border-radius:5px;height:40px;width:200px;color:#fff;margin-top:20px;border:none;font-size:17px;cursor:pointer}button[_ngcontent-%COMP%]:hover{box-shadow:0 0 3px #000}label[_ngcontent-%COMP%]{display:block}.container-input[_ngcontent-%COMP%]{margin-top:20px;height:40px;width:80%}"]});let i=e;return i})();var Pe=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h({type:e,selectors:[["app-page-404"]],standalone:!0,features:[g],decls:3,vars:0,template:function(t,n){t&1&&(c(0,"p"),p(1,"page-404 works!"),l(),p(2,`,
`))},dependencies:[A]});let i=e;return i})();var Me=(i,e)=>{let r=s(y),o=s(v),t=localStorage.getItem("lastPath");return t&&r.authStatus()===d.authenticated?(o.navigateByUrl(t),!1):!0};var Re=(i,e)=>{let r="1",o={"all-products":"2",cart:"3","category-list":"3",coins:"4","main-content":"1",orders:"6",pendings:"5","products-list":"1",profile:"8",storage:"7","users-list":"2","wish-list":"4"},t=e.url.split("/")[2];return t.includes("details")||t.includes("query")?r="2":r=o[t]||"1",localStorage.setItem("lastPath",e.url),localStorage.setItem("activeMenu",r),!0};var Fe=[{path:"auth",canActivate:[Me],component:we},{path:"dashboard",canActivateChild:[Re],loadChildren:()=>import("./chunk-MYI72CH4.js").then(i=>i.DASHBOARD_ROUTES)},{path:"",redirectTo:"auth",pathMatch:"full"},{path:"**",component:Pe}];var Ve="@",Le=(()=>{let e=class e{constructor(o,t,n,a,u){this.doc=o,this.delegate=t,this.zone=n,this.animationType=a,this.moduleImpl=u,this._rendererFactoryPromise=null,this.scheduler=s(W,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-OKZKPF5B.js").then(t=>t)).catch(t=>{throw new L(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:n})=>{this._engine=t(this.animationType,this.doc);let a=new n(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(o,t){let n=this.delegate.createRenderer(o,t);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let a=new H(n);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(u=>{let He=u.createRenderer(o,t);a.use(He),this.scheduler?.notify(9)}).catch(u=>{a.use(n)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(t){z()},e.\u0275prov=b({token:e,factory:e.\u0275fac});let i=e;return i})(),H=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let r of this.replay)r(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,r){return this.delegate.createElement(e,r)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,r){this.delegate.appendChild(e,r)}insertBefore(e,r,o,t){this.delegate.insertBefore(e,r,o,t)}removeChild(e,r,o){this.delegate.removeChild(e,r,o)}selectRootElement(e,r){return this.delegate.selectRootElement(e,r)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,r,o,t){this.delegate.setAttribute(e,r,o,t)}removeAttribute(e,r,o){this.delegate.removeAttribute(e,r,o)}addClass(e,r){this.delegate.addClass(e,r)}removeClass(e,r){this.delegate.removeClass(e,r)}setStyle(e,r,o,t){this.delegate.setStyle(e,r,o,t)}removeStyle(e,r,o){this.delegate.removeStyle(e,r,o)}setProperty(e,r,o){this.shouldReplay(r)&&this.replay.push(t=>t.setProperty(e,r,o)),this.delegate.setProperty(e,r,o)}setValue(e,r){this.delegate.setValue(e,r)}listen(e,r,o){return this.shouldReplay(r)&&this.replay.push(t=>t.listen(e,r,o)),this.delegate.listen(e,r,o)}shouldReplay(e){return this.replay!==null&&e.startsWith(Ve)}};function ke(i="animations"){return Y("NgAsyncAnimations"),$([{provide:X,useFactory:(e,r,o)=>new Le(e,r,o,i),deps:[ie,ce,Z]},{provide:q,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Ne=_(O()),Te=(i,e)=>e(i).pipe(S(r=>(Ne.default.fire("Error Interno","Ha ocurrido algo grave. Contacte a soporte por favor","error"),I(()=>r))));var Oe=(i,e)=>{let r=localStorage.getItem("token"),o=new x({"Content-Type":"application/json","access-token":r??""}),t=i.clone({headers:o});return e(t)};var De={providers:[ue(Fe),se(le([Te,Oe])),ke()]};var je=(()=>{let e=class e{constructor(){this.authService=s(y),this.router=s(v)}ngOnInit(){let o=localStorage.getItem("token"),t=localStorage.getItem("lastPath");if(!o||!t){this.router.navigateByUrl("auth"),this.authService.logout();return}}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h({type:e,selectors:[["app-root"]],standalone:!0,features:[g],decls:1,vars:0,template:function(t,n){t&1&&C(0,"router-outlet")},dependencies:[de]});let i=e;return i})();pe(je,De).catch(i=>console.error(i));
